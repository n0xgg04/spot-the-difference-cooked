<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.image.Image?>

<StackPane xmlns="http://javafx.com/javafx"
           xmlns:fx="http://javafx.com/fxml"
           fx:controller="com.ltm.game.client.controllers.LobbyController">
    
    <!-- Background Forest Image -->
    <ImageView fitWidth="1920" fitHeight="1080" preserveRatio="false" pickOnBounds="false">
        <image>
            <Image url="@../images/v2/forest-8227410.jpg"/>
        </image>
    </ImageView>
    
    <!-- Dark Overlay for better contrast -->
    <Pane style="-fx-background-color: rgba(0, 0, 0, 0.2);" pickOnBounds="false"/>
    
    <!-- Main Content -->
    <BorderPane fx:id="rootPane" pickOnBounds="false">
        
        <!-- TOP: User Info Header -->
        <top>
            <HBox alignment="CENTER_LEFT" spacing="20" 
                  style="-fx-background-color: rgba(20, 30, 48, 0.9); 
                         -fx-background-radius: 0 0 15px 15px; 
                         -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.5), 15, 0.6, 0, 3);">
                <padding>
                    <Insets top="15" right="30" bottom="15" left="30"/>
                </padding>
                
                <!-- User Avatar Circle -->
                <StackPane style="-fx-background-color: linear-gradient(to bottom right, #667eea, #764ba2); 
                                  -fx-background-radius: 50%; 
                                  -fx-min-width: 50px; -fx-min-height: 50px; 
                                  -fx-max-width: 50px; -fx-max-height: 50px;
                                  -fx-effect: dropshadow(gaussian, rgba(102,126,234,0.6), 10, 0.7, 0, 0);">
                    <Label text="ðŸ‘¤" style="-fx-font-size: 24px;"/>
                </StackPane>
                
                <!-- User Info -->
                <VBox spacing="3">
                    <Label fx:id="headerUserInfo"
                           text="Xin chÃ o, Player"
                           style="-fx-font-size: 18px; 
                                  -fx-font-weight: bold; 
                                  -fx-text-fill: white; 
                                  -fx-effect: dropshadow(gaussian, black, 3, 0.7, 0, 1);"/>
                    <Label text="Sáºµn sÃ ng chiáº¿n Ä‘áº¥u!"
                           style="-fx-font-size: 12px; 
                                  -fx-text-fill: #90EE90; 
                                  -fx-font-style: italic;"/>
                </VBox>
                
                <Region HBox.hgrow="ALWAYS"/>
                
                <!-- Mute Button -->
                <Button fx:id="muteButton"
                        text="ðŸ”Š"
                        onAction="#handleToggleMute"
                        style="-fx-font-size: 20px; 
                               -fx-padding: 10px 15px; 
                               -fx-background-color: rgba(52, 73, 94, 0.8); 
                               -fx-text-fill: white; 
                               -fx-background-radius: 50%; 
                               -fx-cursor: hand;
                               -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.4), 8, 0.5, 0, 2);"/>
                
                <!-- Logout Button -->
                <Button text="ðŸšª ThoÃ¡t"
                        onAction="#handleLogout"
                        style="-fx-font-size: 14px; 
                               -fx-padding: 10px 25px; 
                               -fx-background-color: #e74c3c; 
                               -fx-text-fill: white; 
                               -fx-background-radius: 25px; 
                               -fx-cursor: hand; 
                               -fx-font-weight: bold;
                               -fx-effect: dropshadow(gaussian, rgba(231,76,60,0.6), 10, 0.6, 0, 3);"/>
            </HBox>
        </top>
        
        <!-- LEFT: Player List -->
        <left>
            <VBox spacing="15" maxWidth="380" minWidth="380"
                  style="-fx-background-color: rgba(20, 30, 48, 0.92); 
                         -fx-background-radius: 15px; 
                         -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.6), 20, 0.7, 0, 5);">
                <padding>
                    <Insets top="20" right="20" bottom="20" left="20"/>
                </padding>
                <BorderPane.margin>
                    <Insets top="20" right="0" bottom="20" left="20"/>
                </BorderPane.margin>
                
                <!-- Header -->
                <Label text="ðŸŒŸ NGÆ¯á»œI CHÆ I ONLINE"
                       style="-fx-font-size: 20px; 
                              -fx-font-weight: bold; 
                              -fx-text-fill: white; 
                              -fx-effect: dropshadow(gaussian, rgba(102,126,234,0.8), 8, 0.7, 0, 0);"/>
                
                <!-- Search Box -->
                <TextField fx:id="searchField"
                           promptText="ðŸ” TÃ¬m kiáº¿m ngÆ°á»i chÆ¡i..."
                           style="-fx-font-size: 14px; 
                                  -fx-padding: 12px 15px; 
                                  -fx-background-color: rgba(255, 255, 255, 0.15); 
                                  -fx-background-radius: 25px; 
                                  -fx-text-fill: white;
                                  -fx-prompt-text-fill: rgba(255, 255, 255, 0.6);
                                  -fx-border-color: rgba(102, 126, 234, 0.5); 
                                  -fx-border-radius: 25px; 
                                  -fx-border-width: 2px;
                                  -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 8, 0.4, 0, 2);"/>
                
                <!-- Player Table -->
                <TableView fx:id="lobbyTable"
                           VBox.vgrow="ALWAYS"
                           style="-fx-background-color: rgba(255, 255, 255, 0.1); 
                                  -fx-background-radius: 12px; 
                                  -fx-border-color: rgba(102, 126, 234, 0.3);
                                  -fx-border-radius: 12px;
                                  -fx-border-width: 1px;
                                  -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 10, 0.5, 0, 2);">
                    <placeholder>
                        <Label text="KhÃ´ng cÃ³ ngÆ°á»i chÆ¡i nÃ o online"
                               style="-fx-text-fill: rgba(255,255,255,0.7);"/>
                    </placeholder>
                    <columns>
                        <TableColumn fx:id="colUser" text="ðŸ‘¤ NgÆ°á»i chÆ¡i" prefWidth="140"
                                     style="-fx-alignment: CENTER-LEFT;"/>
                        <TableColumn fx:id="colPoints" text="â­ Äiá»ƒm" prefWidth="80"
                                     style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="colStatus" text="ðŸ“Š TT" prefWidth="70"
                                     style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="colAction" text="ðŸŽ¯" prefWidth="70"
                                     style="-fx-alignment: CENTER;"/>
                    </columns>
                </TableView>
                
                <!-- Auto Refresh -->
                <CheckBox fx:id="autoRefresh"
                          text="ðŸ”„ Tá»± Ä‘á»™ng lÃ m má»›i"
                          selected="true"
                          style="-fx-text-fill: white; 
                                 -fx-font-size: 13px;"/>
            </VBox>
        </left>
        
        <!-- BOTTOM RIGHT: Action Buttons -->
        <bottom>
            <HBox alignment="BOTTOM_RIGHT">
                <BorderPane.margin>
                    <Insets top="0" right="30" bottom="30" left="0"/>
                </BorderPane.margin>
                
                <VBox spacing="15" alignment="BOTTOM_RIGHT">
                    <!-- Main Action Buttons -->
                    <HBox spacing="15" alignment="CENTER_RIGHT">
                        <!-- Random Invite Button -->
                        <VBox spacing="5" alignment="CENTER"
                              style="-fx-background-color: linear-gradient(to bottom, #9b59b6, #8e44ad); 
                                     -fx-background-radius: 15px; 
                                     -fx-padding: 15px 20px;
                                     -fx-cursor: hand;
                                     -fx-effect: dropshadow(gaussian, rgba(155,89,182,0.7), 15, 0.7, 0, 5);"
                              onMouseClicked="#handleRandomInvite">
                            <Label text="ðŸŽ²" style="-fx-font-size: 32px;"/>
                            <Label text="Má»i Ngáº«u NhiÃªn"
                                   style="-fx-font-size: 13px; 
                                          -fx-font-weight: bold; 
                                          -fx-text-fill: white;"/>
                        </VBox>
                        
                        <!-- Leaderboard Button -->
                        <VBox spacing="5" alignment="CENTER"
                              style="-fx-background-color: linear-gradient(to bottom, #f39c12, #e67e22); 
                                     -fx-background-radius: 15px; 
                                     -fx-padding: 15px 20px;
                                     -fx-cursor: hand;
                                     -fx-effect: dropshadow(gaussian, rgba(243,156,18,0.7), 15, 0.7, 0, 5);"
                              onMouseClicked="#handleShowLeaderboard">
                            <Label text="ðŸ†" style="-fx-font-size: 32px;"/>
                            <Label text="Báº£ng Xáº¿p Háº¡ng"
                                   style="-fx-font-size: 13px; 
                                          -fx-font-weight: bold; 
                                          -fx-text-fill: white;"/>
                        </VBox>
                        
                        <!-- Toggle Status Button -->
                        <VBox spacing="5" alignment="CENTER"
                              style="-fx-background-color: linear-gradient(to bottom, #16a085, #1abc9c); 
                                     -fx-background-radius: 15px; 
                                     -fx-padding: 15px 20px;
                                     -fx-cursor: hand;
                                     -fx-effect: dropshadow(gaussian, rgba(22,160,133,0.7), 15, 0.7, 0, 5);"
                              onMouseClicked="#handleToggleStatus">
                            <Label text="ðŸ”„" style="-fx-font-size: 32px;"/>
                            <Label text="Äá»•i Tráº¡ng ThÃ¡i"
                                   style="-fx-font-size: 13px; 
                                          -fx-font-weight: bold; 
                                          -fx-text-fill: white;"/>
                        </VBox>
                    </HBox>
                </VBox>
            </HBox>
        </bottom>
        
    </BorderPane>
    
</StackPane>
